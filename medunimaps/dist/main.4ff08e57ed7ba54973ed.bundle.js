webpackJsonp([0,4],{1136:function(e,t,o){e.exports=o(526)},183:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(e){this.id=e.id,this.name=e.name,this.building=e.building}return e.getDefaultFloor=function(){return new e({id:-1,name:"EG",building:1})},e}()},35:function(e,t,o){"use strict";o.d(t,"a",function(){return r}),o.d(t,"b",function(){return n});var r=!0,n=1},446:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(e){this.id=e.id,this.name=e.name,this.selected=e.selected,this.iconurl=e.icon}return e}()},447:function(e,t,o){"use strict";var r=o(0),n=o(52),i=o(74),a=o(35),s=o(71),c=o(701),l=o(700),u=o(699);o.d(t,"a",function(){return h});var p=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this._applicationMode=s.a.CreateDefault(),this.testString="Hi"}return e.prototype.ngAfterViewInit=function(){var e=this;console.log("INIT!!!"),a.a&&(this.mapService=this.mapServiceHttp),this.testString+=".................",this.loadPOIs(),this.loadBaseMap(),this.createOverlay(),this.select=new ol.interaction.Select({wrapX:!1,layers:function(t){return e.allowOLSelection(t)}}),this.routemap=new c.a,this.routemap.Initialize(),this.navigationmap=new u.a(this.mapService),this.navigationmap.Initialize(this.select),this.roommap=new l.a,this.roommap.Initialize(this.navigationmap),this.modify=new ol.interaction.Modify({features:this.select.getFeatures(),condition:function(t){return e.allowOLModify(t)}});var t=[0,0,51200,25600];new ol.proj.Projection({code:"static-image",units:"pixels",imageExtent:t});this.map=new ol.Map({controls:ol.control.defaults({attributionOptions:{collapsible:!0},zoom:!1}),interactions:ol.interaction.defaults().extend([this.select,this.modify]),layers:[new ol.layer.Tile({source:new ol.source.OSM}),this.poiLayer,this.baseMapLayer,this.routemap.getRouteLayer(),this.routemap.getHiddenRouteLayer(),this.roommap.getRoomLayer(),this.navigationmap.getEdgeLayer(),this.navigationmap.getEdgePathLayer()],overlays:[this.roomOverlay],target:"map",view:new ol.View({projection:"EPSG:900913",center:ol.proj.fromLonLat([15.47,47.0805]),zoom:18,maxZoom:22,minZoom:1})}),this.map.on("click",function(t){return e.mapClicked(t)}),this.map.on("pointermove",function(t){return e.mapMouseMoved(t)}),this.select.on("select",function(t){return e.selectionChanged(t)})},e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"applicationMode",{set:function(e){if(this.select){var t=this.select.getFeatures();this._applicationMode.mode==s.b.EDIT_NODES&&t.getArray().length>0&&this.navigationmap.updateEdges(t.getArray()),t.clear()}this.roommap&&this.roommap.Clear(),this._applicationMode=e,console.log("TestmapComponent::Set applicationMode - New App Mode: "+this._applicationMode.name)},enumerable:!0,configurable:!0}),e.prototype.keyboardInput=function(e){if(console.log("KEYDOWN: "+e.keyCode),this._applicationMode.mode==s.b.EDIT_NODES&&46==e.keyCode){console.log("KEYDOWN - Delete Edge "+e.keyCode+"#"+this.select.getFeatures().getArray().length),this.navigationmap.deleteSelectedEdge();var t=this.select.getFeatures();t.clear()}},e.prototype.allowOLSelection=function(e){return!(!e.get("isSelectable")||this._applicationMode.mode!=s.b.EDIT_NODES)},e.prototype.selectionChanged=function(e){var t=(e.selected,e.deselected);t.length>0&&this.navigationmap.updateEdges(t)},e.prototype.allowOLModify=function(e){if(this._applicationMode.mode==s.b.EDIT_NODES){var t=this.select.getFeatures().getArray();if(t.length>0)for(var o=0,r=t;o<r.length;o++){var n=r[o],i=n.getGeometry(),c=i.getFirstCoordinate(),l=i.getLastCoordinate();if(this.getDistance(c,e.coordinate)<a.b||this.getDistance(l,e.coordinate)<a.b)return!1}}return!0},e.prototype.getDistance=function(e,t){var o=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(o*o+r*r)},e.prototype.loadPOIs=function(){var e=new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([15.470230579376215,47.0812626175388])),name:"Test Point",description:"dummy description"}),t=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:"assets/testicon.png"})});e.setStyle(t);var o=new ol.source.Vector({features:[e]});this.poiLayer=new ol.layer.Vector({source:o})},e.prototype.loadBaseMap=function(){var e=this,t={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[1722183.8736183767,5955368.127460353],[1722202.0871290227,5955358.871413959],[1722195.2197397628,5955345.435217581]]]}}]};this.baseMapVectorSource=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(t)});var o=function(e){return new ol.style.Style({stroke:new ol.style.Stroke({color:"red",width:1}),fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"})})};this.baseMapLayer=new ol.layer.Vector({source:this.baseMapVectorSource,style:o}),this.mapService.getBaseMap(0).then(function(t){return e.updateBaseMap(t)})},e.prototype.updateBaseMap=function(e){this.baseMapVectorSource.clear(),this.baseMapVectorSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},e.prototype.createOverlay=function(){this.roomPopup=document.getElementById("roomPopup"),console.log(this.roomPopup),this.roomOverlay=new ol.Overlay({element:this.roomPopup,autoPan:!0,autoPanAnimation:{duration:250}})},e.prototype.showRoute=function(e){this.routemap.showRoute(e)},e.prototype.hideRoute=function(){this.routemap.hideRoute()},e.prototype.showRooms=function(e){this.roommap.showRooms(e)},e.prototype.showNavigationEdges=function(e){this.navigationmap.showEdges(e)},e.prototype.mapMouseMoved=function(e){if(!e.dragging){var t=this.map.getEventPixel(e.originalEvent);this._applicationMode.mode==s.b.EDIT_NODES&&this.roommap.mouseMoved(t,this.map)}},e.prototype.mapClicked=function(e){ol.proj.transform(e.coordinate,"EPSG:3857","EPSG:4326");console.log("Coord Org: "+e.coordinate+" strg: "+e.originalEvent.ctrlKey),console.log("Number of selected features: "+this.select.getFeatures().getArray().length),this._applicationMode.mode==s.b.EDIT_NODES&&(e.originalEvent.ctrlKey?this.roommap.mouseClickedCtrl(e.coordinate,this.map):this.roommap.mouseClicked(e.coordinate,this.map));e.coordinate},p([o.i(r.B)(),d("design:type","function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object),d("design:paramtypes",["function"==typeof(h="undefined"!=typeof s.a&&s.a)&&h||Object])],e.prototype,"applicationMode",null),p([o.i(r.E)("window:keydown",["$event"]),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],e.prototype,"keyboardInput",null),e=p([o.i(r.G)({selector:"app-testmap",template:o(874),styles:[o(865)]}),o.i(r.R)(),d("design:paramtypes",["function"==typeof(y="undefined"!=typeof i.a&&i.a)&&y||Object,"function"==typeof(g="undefined"!=typeof n.a&&n.a)&&g||Object])],e);var t,h,y,g}()},52:function(e,t,o){"use strict";var r=o(0),n=o(689),i=o(688),a=o(690),s=o(692),c=o(693),l=o(691),u=o(876);o.n(u);o.d(t,"a",function(){return h});var p=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(){}return e.prototype.getBaseMapIntern=function(e){return 1==e?Promise.resolve(n.a):Promise.resolve(i.a)},e.prototype.getBaseMap=function(e){var t=this;return new Promise(function(e){return setTimeout(e,200)}).then(function(){return t.getBaseMapIntern(e)})},e.prototype.getFloorNames=function(){return u.Observable.of(a.a)},e.prototype.getRooms=function(e){return null},e.prototype.getDoors=function(e){return null},e.prototype.getFloors=function(e){return null},e.prototype.getNavigationEdges=function(e){return this.getNavigationEdgesIntern(e)},e.prototype.getNavigationEdgesIntern=function(e){return u.Observable.of(l.a)},e.prototype.getRoute=function(e,t){return console.log("Get Route Local!"),u.Observable.of(c.a)},e.prototype.getPoiTypes=function(){return null},e.prototype.getPoiInstances=function(e){return null},e.prototype.searchRoom=function(e){var t=[];if(0==e.length)return u.Observable.of(t);for(var o=0;o<s.a.length;o++)s.a[o].name.startsWith(e)&&t.push(s.a[o]);return u.Observable.of(t)},e.prototype.getNavigationNodes=function(e){return u.Observable.of({geojson:{type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]}})},e.prototype.addNode=function(e,t){return null},e.prototype.addEdge=function(e,t,o,r){return null},e.prototype.addPoiInstance=function(e,t,o){return null},e.prototype.deleteNode=function(e){return null},e.prototype.deleteEdge=function(e){return null},e.prototype.deletePoi=function(e){return null},e.prototype.updateNode=function(e,t){return null},e.prototype.updateEdge=function(e,t){return null},e.prototype.updatePoi=function(e,t){return null},e=p([o.i(r.R)(),d("design:paramtypes",[])],e)}()},525:function(e,t){function o(e){throw new Error("Cannot find module '"+e+"'.")}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id=525},526:function(e,t,o){"use strict";var r=o(703),n=(o.n(r),o(652)),i=o(0),a=o(702),s=o(673);a.a.production&&o.i(i._37)(),o.i(n.a)().bootstrapModule(s.a)},672:function(e,t,o){"use strict";var r=o(0),n=o(407),i=o(71),a=o(183);o.d(t,"a",function(){return u}),o.d(t,"b",function(){return p});var s=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(o,r){t(o,r,e)}},u=function(){function e(e){this._dialog=e,this.currentAppMode=i.a.CreateDefault(),this.currentFloor=a.a.getDefaultFloor(),this.currentPoiType=null,this.poiTypes=null,this.showPoiSelector=!1}return e.prototype.ngOnInit=function(){},e.prototype.openDialog=function(){var e=this,t=this._dialog.open(p);t.afterClosed().subscribe(function(t){e.lastDialogResult=t})},e.prototype.sayHi=function(){console.info("Hi")},e.prototype.appModeChanged=function(e){console.log("AppComponent --- appModeChanged: "+e.name),this.currentAppMode=e,this.showPoiSelector=this.currentAppMode.mode==i.b.EDIT_POIS},e.prototype.floorChanged=function(e){e&&(console.log("AppComponent --- floorChanged: "+e.name),this.currentFloor=e)},e.prototype.currentPoiTypeChanged=function(e){e&&(console.log("AppComponent --- currentPoiType: "+e.name),this.currentPoiType=e)},e.prototype.PoiTypesReceived=function(e){e&&(console.log("AppComponent --- PoiTypesReceived: "+e.length),this.poiTypes=e)},e=s([o.i(r.G)({selector:"app-root",template:o(866),styles:[o(857)]}),c("design:paramtypes",["function"==typeof(t="undefined"!=typeof n.a&&n.a)&&t||Object])],e);var t}(),p=function(){function e(e){this.dialogRef=e}return e=s([o.i(r.G)({template:'\n    <p>This is a dialog</p>\n    <p>\n      <label>\n        This is a text box inside of a dialog.\n        <input #dialogInput>\n      </label>\n    </p>\n    <p> <button md-button (click)="dialogRef.close(dialogInput.value)">CLOSE</button> </p>\n  '}),l(0,o.i(r.x)()),c("design:paramtypes",["function"==typeof(t="undefined"!=typeof n.b&&n.b)&&t||Object])],e);var t}()},673:function(e,t,o){"use strict";var r=o(70),n=o(0),i=o(34),a=o(124),s=o(407),c=o(52),l=o(74),u=o(687),p=o(672),d=o(447),h=o(696),y=o(686),g=o(697),f=o(698),m=o(694),S=o(675),v=o(695);o.d(t,"a",function(){return w});var F=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},b=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(){function e(){}return e=F([o.i(n.I)({declarations:[p.a,p.b,d.a,h.a,y.a,g.a,f.a,m.a,S.a,v.a],imports:[r.e,i.b,a.b,i.e,s.c.forRoot()],providers:[c.a,u.a,l.a],entryComponents:[p.b],bootstrap:[p.a]}),b("design:paramtypes",[])],e)}()},674:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){this.x=0,this.y=0}return e.prototype.createFromAr=function(e){this.x=e[0],this.y=e[1]},e.prototype.getAr=function(){return[this.x,this.y]},e}()},675:function(e,t,o){"use strict";var r=o(0),n=o(52),i=o(74),a=o(35),s=o(71),c=o(183),l=o(446),u=o(680),p=o(676),d=o(682),h=o(679),y=o(677),g=o(678),f=o(683),m=o(685),S=o(73);o.d(t,"a",function(){return b});var v=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},F=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.mapNodes=null,this.mapDoors=null,this.mapRooms=null,this.mapFloor=null,this.mapEdges=null,this.mapEditEdges=null,this.mapRoute=null,this.mapPois=null,this.ctlPressed=!1}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){var e=this;a.a&&(this.mapService=this.mapServiceHttp),this.mapFloor=new h.a(this.mapService),this.mapDoors=new p.a(this.mapService),this.mapRooms=new d.a(this.mapService),this.mapEdges=new y.a(this.mapService),this.mapEditEdges=new g.a(this.mapService),this.mapRoute=new f.a(this.mapService),this.mapNodes=new u.a(this.mapService,this.mapEditEdges,this.mapEdges,this.mapRoute),this.mapPois=new m.a(this.mapService),this.map=new ol.Map({controls:ol.control.defaults({attributionOptions:{collapsible:!0},zoom:!1}),layers:[new ol.layer.Tile({source:new ol.source.OSM}),this.mapFloor.getLayer(),this.mapRooms.getLayer(),this.mapDoors.getLayer(),this.mapNodes.getLayer(),this.mapEditEdges.getLayer(),this.mapEdges.getLayer(),this.mapRoute.getLayer(),this.mapPois.getLayer()],overlays:[],target:"map",view:new ol.View({projection:"EPSG:900913",center:ol.proj.fromLonLat([15.47,47.0805]),zoom:18,maxZoom:24,minZoom:1})}),this.mapNodes.extendMap(this.map),this.map.on("click",function(t){return e.mapClicked(t)}),this.map.on("pointermove",function(t){return e.mapMouseMoved(t)})},Object.defineProperty(e.prototype,"applicationMode",{set:function(e){S.a.CurrentApplicationMode=e,console.log("EditAbleMapComponent::Set applicationMode - New App Mode: "+S.a.CurrentApplicationMode.name),this.updateLayers()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFloor",{set:function(e){console.log("EditAbleMapComponent::Set currentFloor - New Floor: "+JSON.stringify(e)),e&&e.id>=0&&(this.mapFloor.updateData(e.id),this.mapRooms.updateData(e.id),this.mapDoors.updateData(e.id),this.mapEdges.updateData(e.id),this.mapNodes.updateData(e.id),this.mapRoute.setCurrentFloor(e.id),this.mapPois.setCurrentFloor(e.id),this.mapPois.updateData(e.id))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPoiType",{set:function(e){e&&(console.log("EditAbleMapComponent::Set currentPoiType: "+JSON.stringify(e)),this.mapPois.setCurrentSelectedPoiType(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"poiTypes",{set:function(e){e&&(console.log("EditAbleMapComponent::Set poiTypes: "+JSON.stringify(e)),this.mapPois.setPoiTypes(e))},enumerable:!0,configurable:!0}),e.prototype.keyboardInput=function(e){17!=e.keyCode||this.ctlPressed||(this.ctlPressed=!0,this.mapNodes.ctlPressed()),16==e.keyCode&&this.mapRoute.shiftPressed()},e.prototype.keyboardKeyUp=function(e){17==e.keyCode&&(this.ctlPressed=!1,this.mapNodes.ctlReleased()),S.a.CurrentApplicationMode.mode==s.b.EDIT_NODES&&46==e.keyCode&&(this.mapNodes.deleteSelectedNodes(),this.mapEdges.deleteSelectedEdges()),S.a.CurrentApplicationMode.mode==s.b.EDIT_POIS&&46==e.keyCode&&this.mapPois.deleteSelectedPoi(),16==e.keyCode&&this.mapRoute.shiftReleased(),S.a.CurrentApplicationMode.mode==s.b.EDIT_NODES&&88==e.keyCode&&this.mapRoute.clear()},e.prototype.mapMouseMoved=function(e){var t=this.map.getEventPixel(e.originalEvent);S.a.CurrentApplicationMode.mode==s.b.EDIT_NODES&&this.mapNodes.mouseMoved(t,e.coordinate,this.map)},e.prototype.mapClicked=function(e){console.log("Coord Org: "+e.coordinate+" strg: "+e.originalEvent.ctrlKey+" shift: "+e.originalEvent.shiftKey);var t=this.map.getEventPixel(e.originalEvent);S.a.CurrentApplicationMode.mode==s.b.EDIT_NODES?this.mapNodes.mouseClicked(e.coordinate,this.map):S.a.CurrentApplicationMode.mode==s.b.EDIT_POIS&&this.mapPois.mouseClicked(e.coordinate,t,e.originalEvent.ctrlKey,e.originalEvent.shiftKey,this.map)},e.prototype.updateLayers=function(){S.a.CurrentApplicationMode.mode==s.b.EDIT_NODES?(this.setLayerActive(this.mapEdges,!0),this.setLayerActive(this.mapEditEdges,!0),this.setLayerActive(this.mapNodes,!0),this.setLayerActive(this.mapRoute,!0),this.setLayerActive(this.mapPois,!1)):S.a.CurrentApplicationMode.mode==s.b.EDIT_POIS&&(this.setLayerActive(this.mapEdges,!1),this.setLayerActive(this.mapEditEdges,!1),this.setLayerActive(this.mapNodes,!1),this.setLayerActive(this.mapRoute,!1),this.setLayerActive(this.mapPois,!0))},e.prototype.setLayerActive=function(e,t){e&&e.setActive(t)},v([o.i(r.B)(),F("design:type","function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object),F("design:paramtypes",["function"==typeof(b="undefined"!=typeof s.a&&s.a)&&b||Object])],e.prototype,"applicationMode",null),v([o.i(r.B)(),F("design:type","function"==typeof(w="undefined"!=typeof c.a&&c.a)&&w||Object),F("design:paramtypes",["function"==typeof(E="undefined"!=typeof c.a&&c.a)&&E||Object])],e.prototype,"currentFloor",null),v([o.i(r.B)(),F("design:type","function"==typeof(O="undefined"!=typeof l.a&&l.a)&&O||Object),F("design:paramtypes",["function"==typeof(R="undefined"!=typeof l.a&&l.a)&&R||Object])],e.prototype,"currentPoiType",null),v([o.i(r.B)(),F("design:type",Array),F("design:paramtypes",[Array])],e.prototype,"poiTypes",null),v([o.i(r.E)("window:keydown",["$event"]),F("design:type",Function),F("design:paramtypes",[Object]),F("design:returntype",void 0)],e.prototype,"keyboardInput",null),v([o.i(r.E)("window:keyup",["$event"]),F("design:type",Function),F("design:paramtypes",[Object]),F("design:returntype",void 0)],e.prototype,"keyboardKeyUp",null),e=v([o.i(r.G)({selector:"app-editablemap",template:o(867),styles:[o(858)]}),F("design:paramtypes",["function"==typeof(P="undefined"!=typeof i.a&&i.a)&&P||Object,"function"==typeof(L="undefined"!=typeof n.a&&n.a)&&L||Object])],e);var t,b,w,E,O,R,P,L}()},676:function(e,t,o){"use strict";var r=o(73),n=o(72);o.d(t,"a",function(){return a});var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},a=function(e){function t(t){e.call(this),this.mapService=t,this.Initialize()}return i(t,e),t.prototype.Initialize=function(){var e=r.a.CreateBasicLayer(new ol.style.Style({fill:new ol.style.Fill({color:"rgba(212, 209, 203,1.0)"})}));e.layer.set("maxResolution",.2),this.layerSource=e.layerSource,this.layer=e.layer},t.prototype.updateData=function(e){var t=this;console.log("MapDoors::showFloor - "+e),this.clear(),this.subscribeNewRequest(this.mapService.getDoors(e).subscribe(function(e){return t.showDoors(e)},function(e){return console.log("ERROR deleteNode: "+e)}))},t.prototype.showDoors=function(e){console.log("MapDoors::showDoors"),this.clear(),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.getDummyDoors=function(){return{type:"FeatureCollection",features:[{type:"Feature",id:12,geometry:{type:"Polygon",coordinates:[[[1722150.9832473625,5955259.831606609],[1722152.513480839,5955262.780105258],[1722153.8944232445,5955262.406877581],[1722152.924031284,5955260.727353034],[1722150.9832473625,5955259.831606609]]]},properties:{}}]}},t}(n.a)},677:function(e,t,o){"use strict";var r=o(35),n=o(72),i=o(73);o.d(t,"a",function(){return s});var a=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},s=function(e){function t(t){e.call(this),this.mapService=t,this.highlightedFeature=null,this.highlightFeatureOverlay=null,this.selectFeature=null,this.selectFeatureOverlay=null,this.Initialize()}return a(t,e),t.prototype.Initialize=function(){var e=i.a.CreateBasicLayer(new ol.style.Style({stroke:new ol.style.Stroke({color:"black",width:4,lineDash:[4,8]})}));this.layerSource=e.layerSource,this.layer=e.layer},t.prototype.updateData=function(e){var t=this;this.subscribeNewRequest(this.mapService.getNavigationEdges(e).subscribe(function(e){return t.showEdges(e)},function(e){return console.log("ERROR deleteNode: "+e)}))},t.prototype.getHighlightedEdgeId=function(){return this.highlightedFeature?this.highlightedFeature.getId():-1},t.prototype.getEdgeForId=function(e){return this.layerSource.getFeatureById(e)},t.prototype.updateMouseMoved=function(e,t,o){var r=this;null===this.highlightFeatureOverlay&&this.initHighlightFeatureOverlay(t);var n={layerFilter:function(e){return r.testLayer(e)}},i=null;o&&(i=t.forEachFeatureAtPixel(e,function(e){return e},n)),i!==this.highlightedFeature&&(this.highlightedFeature&&this.highlightFeatureOverlay.getSource().removeFeature(this.highlightedFeature),i&&this.highlightFeatureOverlay.getSource().addFeature(i),this.highlightedFeature=i)},t.prototype.updateMouseClicked=function(e){console.log("mapEdges::updateMouseClicked..."),this.highlightedFeature?(this.selectFeatureOverlay||this.initSelectFeatureOverlay(e),this.selectFeatureOverlay.getSource().clear(),this.selectFeature=this.highlightedFeature,this.selectFeatureOverlay.getSource().addFeature(this.selectFeature),console.log("mapEdges::updateMouseClicked Select Edge: "+this.selectFeature.getId())):this.clearSelection()},t.prototype.clearSelection=function(){this.selectFeatureOverlay&&(console.log("mapEdges::clearSelection..."),this.selectFeatureOverlay.getSource().clear())},t.prototype.deleteSelectedEdges=function(){var e=this;return r.a?void(this.selectFeature&&this.mapService.deleteEdge(this.selectFeature.getId()).subscribe(function(t){return e.edgeDeleted(t)},function(e){return console.log("ERROR deleteNode: "+e)})):void console.log("Offline mode, dont delete edge!")},t.prototype.deleteEdgeById=function(e){var t=this;return r.a?void this.mapService.deleteEdge(e).subscribe(function(e){return t.edgeDeleted(e)},function(e){return console.log("ERROR deleteNode: "+e)}):void console.log("Offline mode, dont delete edge!")},t.prototype.addNewEdge=function(e,t){var o=this;if(console.log("addNewEdge! - "+JSON.stringify(e.getId())+" to "+t.getId()),e&&t){var r=e.getId(),n=t.getId();if(r!=n){var i=e.getGeometry().getCoordinates(),a=t.getGeometry().getCoordinates(),s=new ol.geom.LineString([i,a]),c=s.getLength(),l={type:"LineString",coordinates:[i,a]};this.mapService.addEdge(r,n,c,l).subscribe(function(e){return o.edgeAdded(e)},function(e){return console.log("ERROR: "+e)})}}},t.prototype.getEdgesForNode=function(e){return this.layerSource.getFeatures().filter(function(t){return t.get("source")==e||t.get("destination")==e})},t.prototype.removeEdgesForNode=function(e){console.log("MapEdges::removeEdgesForNode - "+e);for(var t=this.getEdgesForNode(e),o=0,r=t;o<r.length;o++){var n=r[o];this.layerSource.removeFeature(n)}},t.prototype.edgeDeleted=function(e){var t=this.layerSource.getFeatureById(e.id);t&&(this.layerSource.removeFeature(t),this.clearSelection())},t.prototype.edgeAdded=function(e){this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.initHighlightFeatureOverlay=function(e){this.highlightFeatureOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:e,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"red",width:4})})})},t.prototype.initSelectFeatureOverlay=function(e){console.log("mapEdges::initSelectFeatureOverlay..."),this.selectFeatureOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:e,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,190,255,0.8)",width:6})})})},t.prototype.testLayer=function(e){return this.layer===e},t.prototype.showEdges=function(e){console.log("MapEdges::showEdges"),this.clear(),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t}(n.a)},678:function(e,t,o){"use strict";var r=o(674),n=o(72),i=o(73);o.d(t,"a",function(){return s});var a=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},s=function(e){function t(t){e.call(this),this.mapService=t,this.startPositions=null,this.Initialize()}return a(t,e),t.prototype.Initialize=function(){var e=i.a.CreateBasicLayer(new ol.style.Style({stroke:new ol.style.Stroke({color:"gray",width:3})}));this.layerSource=e.layerSource,this.layer=e.layer,this.lineAr=[],this.multiLineString=new ol.geom.MultiLineString(this.lineAr),this.multiLineFeature=new ol.Feature({geometry:this.multiLineString,name:"Lines"}),this.layerSource.addFeature(this.multiLineFeature)},t.prototype.setNewStartPos=function(e){var t=new r.a;t.createFromAr(e),this.startPositions=[t]},t.prototype.setNewStartPositionsForEdgeFeatures=function(e,t){this.startPositions=[];for(var o=0,n=t;o<n.length;o++){var i=n[o],a=i.getGeometry().getFirstCoordinate();i.get("source")==e&&(a=i.getGeometry().getLastCoordinate());var s=new r.a;s.createFromAr(a),this.startPositions.push(s)}},t.prototype.setNewEndPos=function(e){if(null!=this.startPositions){this.lineAr=[];for(var t=0,o=this.startPositions;t<o.length;t++){var r=o[t];this.lineAr.push([r.getAr(),e])}this.multiLineString.setCoordinates(this.lineAr)}},t.prototype.clear=function(){this.startPositions=null,this.lineAr=[],this.multiLineString.setCoordinates(this.lineAr)},t.prototype.setNewLine=function(e,t){console.log("MapEditEdges::setNewLine - "),this.lineAr=[],this.lineAr.push([e,t]),this.multiLineString.setCoordinates(this.lineAr)},t.prototype.updateEdges=function(e,t){for(var o=this,r=t.getGeometry().getCoordinates(),n=0,i=e;n<i.length;n++){var a=i[n],s=a.getGeometry().getCoordinates();a.get("source")==t.getId()?s[0]=r:s[s.length-1]=r,a.getGeometry().setCoordinates(s),this.mapService.updateEdge((new ol.format.GeoJSON).writeFeature(a),a.getId()).subscribe(function(e){return o.edgeUpdated(e)},function(e){return console.log("ERROR: "+e)})}},t.prototype.edgeUpdated=function(e){},t}(n.a)},679:function(e,t,o){"use strict";var r=o(73),n=o(72);o.d(t,"a",function(){return a});var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},a=function(e){function t(t){e.call(this),this.mapService=t,this.Initialize()}return i(t,e),t.prototype.Initialize=function(){var e=r.a.CreateBasicLayer(new ol.style.Style({fill:new ol.style.Fill({color:"rgba(64,64,64,1.0)"})}));this.layerSource=e.layerSource,this.layer=e.layer},t.prototype.updateData=function(e){var t=this;this.clear(),this.subscribeNewRequest(this.mapService.getFloors(e).subscribe(function(e){return t.showFloors(e)},function(e){return console.log("ERROR deleteNode: "+e)}))},t.prototype.showFloors=function(e){console.log("MapFloors::showFloors"),this.clear(),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.getDummyFloor=function(){return{type:"FeatureCollection",features:[{type:"Feature",id:12,geometry:{type:"Polygon",coordinates:[[[1722127.851590177,5955257.966158812],[1722184.2836149659,5955368.142969113],[1722202.4971256119,5955359.185504861],[1722195.33115421,5955345.450726341],[1722198.914139911,5955343.360651349],[1722177.4162257058,5955302.156315789],[1722173.2360757214,5955303.649226498],[1722145.169354398,5955249.307276702],[1722127.851590177,5955257.966158812]]]},properties:{}}]}},t}(n.a)},680:function(e,t,o){"use strict";var r=o(35),n=o(71),i=o(72),a=o(73),s=o(681);o.d(t,"a",function(){return l});var c=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},l=function(e){function t(t,o,r,n){e.call(this),this.mapService=t,this.mapEditEdges=o,this.mapEdges=r,this.mapRoute=n,this.highlightFeatureOverlay=null,this.displayEditLines=!1,this.isModifying=!1,this.lastMousePostion=[0,0],this.currentFloorId=-1,this.ctrlPressed=!1,this.lastSelectedNode=null,this.Initialize()}return c(t,e),t.prototype.Initialize=function(){var e=function(e){return"node"==e.get("ctype")?s.a.VirtualNodeStyle:"point of interest instance"==e.get("ctype")?s.a.PoiNodeStyle:s.a.DefaultNodeStyle},t=a.a.CreateBasicLayer(e);this.layerSource=t.layerSource,this.layer=t.layer},t.prototype.extendMap=function(e){var t=this;this.select=new ol.interaction.Select({wrapX:!1,layers:function(e){return t.testSelect(e)},toggleCondition:ol.events.condition.never}),e.addInteraction(this.select),this.modify=new ol.interaction.Modify({features:this.select.getFeatures(),condition:function(e){return t.testModify(e)}}),e.addInteraction(this.modify),this.select.on("select",function(e){return t.featureSelected(e)}),this.modify.on("modifystart",function(e){return t.featureModifyStart(e)}),this.modify.on("modifyend",function(e){return t.featureModified(e)})},t.prototype.updateData=function(e){var t=this;this.currentFloorId=e,this.clear(),this.subscribeNewRequest(this.mapService.getNavigationNodes(e).subscribe(function(e){return t.showNodes(e)}))},t.prototype.mouseMoved=function(e,t,o){var r=this;this.lastMousePostion=t,null===this.highlightFeatureOverlay&&this.initHighlightFeatureOverlay(o);var n={layerFilter:function(e){return r.testLayer(e)}},i=o.forEachFeatureAtPixel(e,function(e){return e},n);i!==this.highlightedFeature&&(this.highlightedFeature&&this.highlightFeatureOverlay.getSource().removeFeature(this.highlightedFeature),i&&this.highlightFeatureOverlay.getSource().addFeature(i),this.highlightedFeature=i),this.mapEdges.updateMouseMoved(e,o,null==this.highlightedFeature),(this.displayEditLines||this.isModifying)&&this.mapEditEdges.setNewEndPos(t)},t.prototype.mouseClicked=function(e,t){if(this.displayEditLines){var o=null,r=this.select.getFeatures().getArray();r.length>=1&&(o=r[0]),this.highlightedFeature?(this.selectNewNode(this.highlightedFeature),this.addNewEdge(o,this.highlightedFeature)):this.addNewNodeOnPos(o,e)}else this.lastSelectedNode&&this.highlightedFeature&&this.ctrlPressed?(this.selectNewNode(this.highlightedFeature),this.addNewEdge(this.lastSelectedNode,this.highlightedFeature)):this.highlightedFeature?this.mapEdges.clearSelection():this.mapEdges.updateMouseClicked(t);
},t.prototype.ctlPressed=function(){this.ctrlPressed=!0;var e=this.select.getFeatures().getArray();if(e.length>=1){this.displayEditLines=!0;var t=e[0].getGeometry().getCoordinates();console.log("Set Startpoint: "+JSON.stringify(t)),this.mapEditEdges.setNewStartPos(t),this.mapEditEdges.setNewEndPos(this.lastMousePostion)}},t.prototype.ctlReleased=function(){this.ctrlPressed=!1,console.log("ctlReleased..."),this.displayEditLines=!1,this.mapEditEdges.clear()},t.prototype.updateAddNode=function(e,t,o){console.log("updateAddNode! - "+JSON.stringify(e)),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e));var r=this.layerSource.getFeatureById(e.id);if(this.selectNewNode(r),t&&(this.addNewEdge(t,r),console.log("Split Edge?"),o>=0)){var n=this.mapEdges.getEdgeForId(o);if(n){console.log("Split Edge: "+n.getId());var i=this.layerSource.getFeatureById(n.get("source")),a=this.layerSource.getFeatureById(n.get("destination"));this.mapEdges.deleteEdgeById(n.getId()),i&&this.addNewEdge(i,r),a&&this.addNewEdge(a,r)}}},t.prototype.selectNewNode=function(e){var t=this.select.getFeatures();t.clear(),t.push(e);var o=e.getGeometry().getCoordinates();this.mapEditEdges.setNewStartPos(o),this.mapEditEdges.setNewEndPos(o)},t.prototype.addNewEdge=function(e,t){this.mapEdges.addNewEdge(e,t)},t.prototype.deleteSelectedNodes=function(){var e=this;if(!r.a)return void console.log("Offline mode, dont delete edge!");for(var t=0,o=this.select.getFeatures().getArray();t<o.length;t++){var n=o[t];"node"==n.get("ctype")?this.mapService.deleteNode(n.getId()).subscribe(function(t){return e.nodeDeleted(t)},function(e){return console.log("ERROR deleteNode: "+e)}):console.log("Not allowed to delete feature of type: "+n.get("ctype"))}},t.prototype.nodeDeleted=function(e){console.log("edgeDeleted..."+JSON.stringify(e)),this.mapEdges.removeEdgesForNode(e.id);var t=this.layerSource.getFeatureById(e.id);if(t){this.layerSource.removeFeature(t);var o=this.select.getFeatures();o.clear()}},t.prototype.testLayer=function(e){return this.layer===e},t.prototype.testSelect=function(e){return!(!this.testLayer(e)||a.a.CurrentApplicationMode.mode!=n.b.EDIT_NODES)},t.prototype.testModify=function(e){if(a.a.CurrentApplicationMode.mode==n.b.EDIT_NODES){var t=this.select.getFeatures().getArray();return t.length>0&&"node"==t[0].get("ctype")}return!1},t.prototype.addNewNodeOnPos=function(e,t){var o=this;if(!(this.currentFloorId<0)){var r={type:"Point",coordinates:[t[0],t[1]]},n=this.mapEdges.getHighlightedEdgeId();console.log("mouseClicked Add new node: "+JSON.stringify(r)+"   SplitEdgeID: "+n),this.mapService.addNode(this.currentFloorId,r).subscribe(function(t){return o.updateAddNode(t,e,n)},function(e){return console.log("ERROR: "+e)})}},t.prototype.initHighlightFeatureOverlay=function(e){this.highlightFeatureOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:e,style:s.a.higlightStyle})},t.prototype.showNodes=function(e){this.clear(),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.featureSelected=function(e){var t=e.selected;t.length>0&&(console.log("Feature selected => "+t[0].getId()),this.lastSelectedNode=t[0],this.mapRoute.doShowRoute()&&this.mapRoute.generateRoute(t[0].getId()),this.mapRoute.setNewStartPos(t[0].getId()))},t.prototype.featureModified=function(e){var t=this;console.log("MapNodes::featureModifyEnd..."),this.isModifying=!1,this.mapEditEdges.clear();for(var o=e.features.getArray(),r=0,n=o;r<n.length;r++){var i=n[r];console.log("Feature "+i.getId()+" modified!"),this.mapService.updateNode((new ol.format.GeoJSON).writeFeature(i),i.getId()).subscribe(function(e){return t.nodeUpdated(e)},function(e){return console.log("ERROR: "+e)});var a=this.mapEdges.getEdgesForNode(i.getId());this.mapEditEdges.updateEdges(a,i)}},t.prototype.featureModifyStart=function(e){console.log("MapNodes::featureModifyStart...");var t=this.select.getFeatures().getArray();if(console.log("Feature selected: "+t.length),t.length>=1){var o=this.mapEdges.getEdgesForNode(t[0].getId());console.log("Feature selected: "+t[0].getId()+"  Edges: "+o.length),this.mapEditEdges.setNewStartPositionsForEdgeFeatures(t[0].getId(),o)}this.isModifying=!0},t.prototype.nodeUpdated=function(e){console.log("node Updated! - "+JSON.stringify(e))},t.prototype.clearSelection=function(){var e=this.select.getFeatures();e.clear(),this.displayEditLines=!1,this.isModifying=!1},t}(i.a)},681:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){}return e.higlightImage=new ol.style.Circle({radius:7,fill:null,stroke:new ol.style.Stroke({color:"red",width:3})}),e.higlightStyle=new ol.style.Style({image:e.higlightImage}),e.DefaultNodeImage=new ol.style.Circle({radius:5,fill:null,stroke:new ol.style.Stroke({color:"black",width:2})}),e.DefaultNodeStyle=new ol.style.Style({image:e.DefaultNodeImage}),e.VirtualNodeImage=new ol.style.Circle({radius:5,fill:null,stroke:new ol.style.Stroke({color:"green",width:2})}),e.VirtualNodeStyle=new ol.style.Style({image:e.VirtualNodeImage}),e.PoiNodeImage=new ol.style.Circle({radius:5,fill:null,stroke:new ol.style.Stroke({color:"red",width:2})}),e.PoiNodeStyle=new ol.style.Style({image:e.PoiNodeImage}),e}()},682:function(e,t,o){"use strict";var r=o(73),n=o(72);o.d(t,"a",function(){return a});var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},a=function(e){function t(t){e.call(this),this.mapService=t,this.Initialize()}return i(t,e),t.prototype.Initialize=function(){var e=r.a.CreateBasicLayer(new ol.style.Style({fill:new ol.style.Fill({color:"rgba(96,96,255,1)"})}));this.layerSource=e.layerSource,this.layer=e.layer},t.prototype.updateData=function(e){var t=this;this.clear(),this.subscribeNewRequest(this.mapService.getRooms(e).subscribe(function(e){return t.showRooms(e)},function(e){return console.log("ERROR deleteNode: "+e)}))},t.prototype.showRooms=function(e){this.clear();var t=(new ol.format.GeoJSON).readFeatures(e);this.layerSource.addFeatures(t)},t.prototype.getDummyRoom=function(){return{type:"FeatureCollection",features:[{type:"Feature",id:12,geometry:{type:"Polygon",coordinates:[[[1722195.294385298,5955266.126823761],[1722204.811691066,5955261.3495094925],[1722202.1244517902,5955255.975030941],[1722192.6071460224,5955260.90163628],[1722195.294385298,5955266.126823761]]]},properties:{}}]}},t}(n.a)},683:function(e,t,o){"use strict";var r=o(72),n=o(73),i=o(684);o.d(t,"a",function(){return s});var a=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},s=function(e){function t(t){e.call(this),this.mapService=t,this.currentStartNodeId=-1,this.currentFloorId=-1,this.createRoute=!1,this.Initialize()}return a(t,e),t.prototype.Initialize=function(){var e=this,t=function(e,t){var o=null;try{var r=e.get("source_node").properties.floor,n=e.get("destination_node").properties.floor;r!=t&&n!=t||(o=i.a.routeCurrentFloor)}catch(e){}return o?o:i.a.routeHiddenFloor},o=n.a.CreateBasicLayer(function(o){return t(o,e.currentFloorId)});this.layerSource=o.layerSource,this.layer=o.layer},t.prototype.setNewStartPos=function(e){this.currentStartNodeId=e},t.prototype.shiftPressed=function(){this.createRoute=!0},t.prototype.shiftReleased=function(){this.createRoute=!1},t.prototype.doShowRoute=function(){return this.createRoute},t.prototype.generateRoute=function(e){var t=this;this.currentStartNodeId>=0&&e>=0&&(console.log("MapRoute::generateRoute From: "+this.currentStartNodeId+" to "+e),this.subscribeNewRequest(this.mapService.getRoute(this.currentStartNodeId,e).subscribe(function(e){return t.updateRoute(e)},function(e){return console.log("ERROR: "+e)})))},t.prototype.clear=function(){this.layerSource.clear()},t.prototype.setCurrentFloor=function(e){this.currentFloorId=e,this.layerSource.refresh()},t.prototype.updateRoute=function(e){console.log("MapRoute::update Route"),this.layerSource.clear(),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t}(r.a)},684:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){}return e.routeCurrentFloor=new ol.style.Style({stroke:new ol.style.Stroke({color:"green",width:5})}),e.routeHiddenFloor=new ol.style.Style({stroke:new ol.style.Stroke({color:"green",width:5,lineDash:[3,7]})}),e}()},685:function(e,t,o){"use strict";var r=o(35),n=o(72);o.d(t,"a",function(){return a});var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},a=function(e){function t(t){e.call(this),this.mapService=t,this.poitypes=null,this.currentPoiType=null,this.currentFloor=-1,this.iconStyleMap=null,this.currentSelectedPoi=null,this.highlightFeaturePoint=null,this.highlightFeature=null,this.featureAdded=!1,this.Initialize()}return i(t,e),t.prototype.Initialize=function(){this.layerSource=new ol.source.Vector({features:[]}),this.layer=new ol.layer.Vector({source:this.layerSource})},t.prototype.updateData=function(e){var t=this;this.iconStyleMap&&(this.clear(),this.subscribeNewRequest(this.mapService.getPoiInstances(e).subscribe(function(e){return t.showPois(e)},function(e){return console.log("ERROR deleteNode: "+e)})))},t.prototype.setPoiTypes=function(e){this.poitypes=e,this.iconStyleMap={};for(var t=0;t<e.length;t++){var o=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:e[t].iconurl})});this.iconStyleMap[e[t].id]=o}this.currentFloor>=0&&this.updateData(this.currentFloor)},t.prototype.setCurrentSelectedPoiType=function(e){this.currentPoiType=e},t.prototype.setCurrentFloor=function(e){console.log("MapPois::setCurrentFloor"),this.currentFloor=e},t.prototype.mouseClicked=function(e,t,o,r,n){console.log("MapPois::mouseClicked"),o&&this.currentPoiType&&this.currentFloor>=0?(this.clearSelection(),this.createNewPoi(e)):this.currentFloor>=0&&(this.currentSelectedPoi&&r?(console.log("MapPois::mouseClicked Move: "+this.currentSelectedPoi.getId()),this.moveCurrentPoi(e)):this.selectPoi(t,n)?(this.highlightFeature||this.initHighlightFeatureOverlay(n),this.highlightFeaturePoint.setCoordinates(this.currentSelectedPoi.getGeometry().getCoordinates()),this.layerSource.addFeature(this.highlightFeature),this.featureAdded=!0,console.log("MapPois::mouseClicked Select: "+this.currentSelectedPoi.getId())):this.clearSelection())},t.prototype.deleteSelectedPoi=function(){var e=this;return r.a?void(this.currentSelectedPoi&&this.mapService.deletePoi(this.currentSelectedPoi.getId()).subscribe(function(t){return e.poiDeleted(t)},function(e){return console.log("ERROR deletePoi: "+e)})):void console.log("Offline mode, dont delete edge!")},t.prototype.poiDeleted=function(e){console.log("poiDeleted..."+JSON.stringify(e));var t=this.layerSource.getFeatureById(e.id);t&&(this.layerSource.removeFeature(t),this.clearSelection())},t.prototype.moveCurrentPoi=function(e){var t=this;console.log("MapPois::movePoi... "+JSON.stringify(e)),this.currentSelectedPoi&&(this.currentSelectedPoi.getGeometry().setCoordinates(e),this.highlightFeature.getGeometry().setCoordinates(e),this.mapService.updatePoi((new ol.format.GeoJSON).writeFeature(this.currentSelectedPoi),this.currentSelectedPoi.getId()).subscribe(function(e){return t.poiUpdated(e)},function(e){return console.log("ERROR: "+e)}))},t.prototype.poiUpdated=function(e){console.log("Poi Updated! - "+JSON.stringify(e))},t.prototype.selectPoi=function(e,t){var o=this;this.clearSelection();var r={layerFilter:function(e){return o.testLayer(e)}},n=null;return n=t.forEachFeatureAtPixel(e,function(e){return e},r),!!n&&(this.currentSelectedPoi=n,!0)},t.prototype.testLayer=function(e){return this.layer===e},t.prototype.createNewPoi=function(e){var t=this,o={type:"Point",coordinates:[e[0],e[1]]};this.mapService.addPoiInstance(this.currentFloor,o,this.currentPoiType.id).subscribe(function(e){return t.updateAddPoi(e)},function(e){return console.log("ERROR: "+e)})},t.prototype.showPois=function(e){console.log("MapPois::showPois"),this.clear(),this.showPoisWithStyles((new ol.format.GeoJSON).readFeatures(e)),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.showPoisWithStyles=function(e){for(var t=0;t<e.length;t++){var o=e[t].getId(),r=e[t].get("name");console.log("MapPois::showPoisWithStyles: "+o+"#"+r),e[t].setStyle(this.iconStyleMap[r])}this.layerSource.addFeatures(e)},t.prototype.updateAddPoi=function(e){console.log("MapPois::updateAddNode! - "+JSON.stringify(e)),this.showPoisWithStyles((new ol.format.GeoJSON).readFeatures(e)),this.layerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},t.prototype.clearSelection=function(){this.featureAdded&&this.highlightFeature&&(this.layerSource.removeFeature(this.highlightFeature),this.featureAdded=!1),this.currentSelectedPoi=null},t.prototype.initHighlightFeatureOverlay=function(e){this.highlightFeaturePoint=new ol.geom.Point([0,0]),this.highlightFeature=new ol.Feature({geometry:this.highlightFeaturePoint,name:"SelectedPoi"}),this.highlightFeature.setStyle(t.higlightStyle)},t.higlightObject=new ol.style.Circle({radius:7,fill:null,stroke:new ol.style.Stroke({color:"red",width:6})}),t.higlightStyle=new ol.style.Style({image:t.higlightObject}),t}(n.a)},686:function(e,t,o){"use strict";var r=o(0),n=o(52),i=o(74),a=o(35);o.d(t,"a",function(){return l});var s=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.floorList=[],this.selectedFloor=null,this.currentFloorEvt=new r._20}return e.prototype.ngOnInit=function(){a.a&&(this.mapService=this.mapServiceHttp),this.updateData()},e.prototype.updateData=function(){var e=this;this.mapService.getFloorNames().subscribe(function(t){return e.updateFloors(t)},function(e){return console.log("ERROR deleteNode: "+e)})},e.prototype.onSelect=function(e){this.selectFloor(e)},e.prototype.updateFloors=function(e){this.floorList=e;for(var t=0,o=this.floorList;t<o.length;t++){var r=o[t];if("EG"==r.name)return void this.selectFloor(r)}this.floorList.length>0&&this.selectFloor(this.floorList[0])},e.prototype.selectFloor=function(e){this.selectedFloor=e,this.currentFloorEvt.emit(this.selectedFloor)},s([o.i(r.C)(),c("design:type",Object)],e.prototype,"currentFloorEvt",void 0),e=s([o.i(r.G)({selector:"app-floorselector",template:o(868),styles:[o(859)]}),c("design:paramtypes",["function"==typeof(t="undefined"!=typeof i.a&&i.a)&&t||Object,"function"==typeof(l="undefined"!=typeof n.a&&n.a)&&l||Object])],e);var t,l}()},687:function(e,t,o){"use strict";var r=o(0);o.d(t,"a",function(){return a});var n=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=function(){function e(){}return e.prototype.showRoute=function(e){},e.prototype.hideRoute=function(){},e=n([o.i(r.R)(),i("design:paramtypes",[])],e)}()},688:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[1722148.7179484894,5955311.036092768],[1722146.0740319043,5955305.806638332]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722145.4393780732,5955304.280772133],[1722144.3102046154,5955302.047357817]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722156.5486399394,5955306.256258198],[1722151.3915498806,5955308.863588676],[1722127.931174513,5955262.460852391]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.866233931,5955310.209756394],[1722112.6978673185,5955256.472911546],[1722122.082911084,5955251.728004948],[1722126.076234266,5955259.626477143]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722143.3116983555,5955300.0385739],[1722142.058591478,5955297.560029245]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722141.0532015797,5955295.537624686],[1722140.1856665525,5955293.821710152]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.173541809,5955291.819808783],[1722138.5469889154,5955290.580537533]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722137.9410912285,5955289.382120622],[1722137.6381423848,5955288.782912167]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722137.0186251472,5955287.591381051],[1722135.9514194895,5955285.480534063]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722134.9747857354,5955283.785578792],[1722133.7629903613,5955281.38874497]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722133.1843296185,5955280.176557558],[1722132.4613843076,5955278.7466298565]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.9914304577,5955310.161206596],[1722140.1936529577,5955310.058966596],[1722140.4127388278,5955310.492300833],[1722145.1408928542,5955308.101832573]]}}]}},689:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[1722148.7179484894,5955311.036092768],[1722146.0740319043,5955305.806638332]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722145.4393780732,5955304.280772133],[1722144.3102046154,5955302.047357817]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722156.5486399394,5955306.256258198],[1722151.3915498806,5955308.863588676],[1722127.931174513,5955262.460852391]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.866233931,5955310.209756394],[1722112.6978673185,5955256.472911546],[1722122.082911084,5955251.728004948],[1722126.076234266,5955259.626477143]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722143.3116983555,5955300.0385739],[1722142.058591478,5955297.560029245]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722141.0532015797,5955295.537624686],[1722140.1856665525,5955293.821710152]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.173541809,5955291.819808783],[1722138.5469889154,5955290.580537533]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722137.9410912285,5955289.382120622],[1722137.6381423848,5955288.782912167]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722137.0186251472,5955287.591381051],[1722135.9514194895,5955285.480534063]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722134.9747857354,5955283.785578792],[1722133.7629903613,5955281.38874497]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722133.1843296185,5955280.176557558],[1722132.4613843076,5955278.7466298565]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.9914304577,5955310.161206596],[1722140.1936529577,5955310.058966596],[1722140.4127388278,5955310.492300833],[1722145.1408928542,5955308.101832573]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722138.038594267,5955306.179079759],[1722144.6830496874,5955302.819764539]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722135.7410594842,5955301.730400836],[1722142.4240331678,5955298.351611486]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722133.8325794842,5955297.955580836],[1722140.6118477474,5955294.528106706]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722132.0015660073,5955294.238323232],[1722138.703797744,5955290.849797362]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722129.6365151408,5955289.799595839],[1722136.415785561,5955286.372120619]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722133.3726029575,5955287.862334096],[1722134.7650136072,5955290.616410413],[1722137.846498397,5955289.058468022]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722125.925588397,5955282.220528022],[1722132.5507836072,5955278.870950413]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722130.610817744,5955278.860292363],[1722131.0295153542,5955279.688442573]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722129.8911294772,5955277.628127148],[1722129.3945353474,5955276.645903885]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722129.6667453507,5955277.088653229],[1722124.6400720875,5955279.630047359]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722128.7129353473,5955275.297753885],[1722127.9437012174,5955273.776270622]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722128.4004860038,5955274.488433889],[1722123.3738127407,5955277.0298280185]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722127.1545618705,5955272.119756282],[1722123.4154994807,5955264.724191493],[1722118.4273444808,5955267.246111493]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722122.9784653473,5955261.946553886],[1722122.3942370876,5955260.790997359]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722121.7710594772,5955259.558402149],[1722121.6055288278,5955259.230995833],[1722115.7507053544,5955262.191087573]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722127.1905355575,5955262.863966276],[1722132.5831355576,5955260.137566276]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722130.9798149837,5955257.121846492],[1722129.8506415258,5955254.888432178],[1722147.2821563147,5955246.075376894],[1722148.5490336933,5955248.581158493]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722132.440085313,5955260.145429773],[1722155.9048458226,5955306.556839516]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722157.3645080356,5955309.443934019],[1722183.225318291,5955360.594537519],[1722200.6542708513,5955351.758591575],[1722199.753565157,5955349.929230013]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722198.3537092782,5955347.160432989],[1722149.8819030395,5955251.287097337]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722149.8819030395,5955251.287097337],[1722157.9541226493,5955247.205930637],[1722176.3699033493,5955283.6308642505],[1722193.5491868227,5955274.94533251],[1722186.3826503032,5955260.770499457],[1722191.3130268299,5955258.277791197],[1722196.2594950895,5955268.061507724],[1722205.8120998794,5955263.2318853345],[1722168.4604198795,5955189.353265335],[1722158.9078150897,5955194.182887725],[1722162.8026726998,5955201.886602934],[1722157.3330361731,5955204.651951194],[1722157.3330361731,5955204.651951194],[1722141.2322726997,5955212.792202935],[1722157.16223857,5955244.300394671]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722148.5398468156,5955248.562987588],[1722157.1232892193,5955244.223355988]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722190.0277233494,5955255.7355642505],[1722185.405495086,5955258.07247838],[1722175.3567644365,5955238.196897064],[1722179.9789926999,5955235.859982935]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722174.0333716231,5955235.770658151],[1722159.5055540127,5955207.035802942],[1722164.2048209596,5955204.659939461],[1722178.73263857,5955233.394794671]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722178.73263857,5955233.394794671],[1722174.0333716231,5955235.770658151]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722140.357013393,5955310.382080402],[1722137.3386845773,5955311.908092286],[1722149.897288901,5955336.748001939],[1722162.2627709177,5955330.496240233],[1722152.788735943,5955311.757360757],[1722157.3645080356,5955309.443934019]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722149.8477756688,5955313.381052751],[1722152.8438179474,5955311.866308534]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722130.9622755072,5955257.087154819],[1722126.0484391632,5955259.571500665]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722207.7633137836,5955345.9158264045],[1722221.7069020541,5955373.495122952],[1722239.1943337908,5955364.653797083],[1722221.04429965,5955328.754488798],[1722203.5568679133,5955337.595814668],[1722206.3222161732,5955343.065451194]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722207.7209011305,5955345.927597744],[1722199.706457837,5955349.9795537945]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722206.2832679134,5955342.988414668],[1722198.2880848302,5955347.030633107]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722049.4669066695,5955131.340529937],[1722049.1639491015,5955130.741304225],[1722061.3660094535,5955124.572165527],[1722075.6788024392,5955152.881719317],[1722072.9488957562,5955154.261910242],[1722091.4299879135,5955190.816024668]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722093.0649668297,5955193.858561198],[1722105.4895609596,5955218.433409461],[1722095.9369561698,5955223.263031851],[1722080.8249113904,5955193.372622271],[1722078.1671296537,5955194.7163481405],[1722075.5186261733,5955189.477821194]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722074.0775296537,5955186.627448141],[1722068.3910335512,5955175.380016039],[1722071.0488152879,5955174.03629017],[1722051.0292526896,5955134.439204904]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722051.0292526896,5955134.439204904],[1722042.863314006,5955138.567754255]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722049.4669066695,5955131.340529937],[1722041.220516865,5955135.509753904]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722075.5186261733,5955189.477821194],[1722069.927088845,5955192.304800271]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722074.0775296537,5955186.627448141],[1722068.4587553814,5955189.468197719]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722097.6015840345,5955191.372955843],[1722107.1307010136,5955210.220783096],[1722124.72563531,5955201.325105896],[1722115.2516003351,5955182.5862264205]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722096.2266244434,5955188.632755751],[1722079.9461231441,5955156.431233118],[1722097.587630091,5955147.512009638],[1722113.90707965,5955179.790568798]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722093.0649668297,5955193.858561198],[1722097.6788840177,5955191.525848996]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722096.2266244434,5955188.632755751],[1722091.5080994435,5955191.018355751],[1722091.4107277032,5955190.825762278]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722123.1670161732,5955178.591151194],[1722130.7035644331,5955193.49783772],[1722148.229514433,5955184.6370377205],[1722138.005514433,5955164.414787721],[1722120.479564433,5955173.275587721],[1722121.6674961732,5955175.625221194]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722115.2543441842,5955182.591653532],[1722123.1670161732,5955178.591151194]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722113.90707965,5955179.790568798],[1722121.84190444,5955175.778866407]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722204.85786097,5955261.344477491],[1722195.3052561802,5955266.174099881]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722194.6203413904,5955259.749362271],[1722202.13146097,5955255.951877492]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722193.0157085734,5955254.853634014],[1722199.8334951,5955251.406685755]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722191.0691403067,5955251.194798801],[1722197.9639633598,5955247.708902282]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722188.829597917,5955246.765164011],[1722195.72442097,5955243.279267492]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722186.3771279065,5955242.20135598],[1722193.3875057495,5955238.657037071]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722184.2730444332,5955237.848327721],[1722191.2063857496,5955234.342957071]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722179.3642344433,5955227.85211575],[1722181.370085093,5955231.819527067],[1722188.1878716196,5955228.372578808]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722178.2355861766,5955225.811060538],[1722176.9892320468,5955223.345872275]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722176.034130963,5955221.2654388035],[1722175.1383144434,5955219.49358575]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722174.125650963,5955217.490618804],[1722172.918245093,5955215.102467068]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722171.8480203066,5955213.176968801],[1722170.9132544366,5955211.328077064]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722169.9200661767,5955209.363630538],[1722168.6347626965,5955206.821403591]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722167.6610485665,5955204.895475327],[1722166.8041803066,5955203.200658801]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722165.7915179168,5955201.197694011],[1722165.3630826965,5955200.350283591],[1722172.2579057496,5955196.864387072]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722163.9768455203,5955201.147870534],[1722162.7442503101,5955201.771048144]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722167.2326144367,5955204.048067064],[1722174.1274374898,5955200.562170545]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722169.5695285664,5955208.670295327],[1722176.4643516196,5955205.184398808]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722171.4390603066,5955212.368078801],[1722178.3338833598,5955208.882182281]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722173.7945885733,5955216.8358040145],[1722180.6123751,5955213.388855755]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722175.6251709631,5955220.4565488035],[1722182.4429574898,5955217.009600544]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722177.8655744365,5955225.079207064],[1722184.7603974896,5955221.593310544]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722182.6026803032,5955231.196349458],[1722182.9921661732,5955231.966721195]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722183.5954385665,5955233.064285328],[1722184.4328326965,5955234.720583591]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722187.6806144365,5955244.492567064],[1722189.105800963,5955243.772018804],[1722187.9178692228,5955241.42238533]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722188.9066344434,5955246.726215751],[1722189.099227917,5955246.628844012]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722190.3083527067,5955249.403041622],[1722191.5352327067,5955251.829711622]]}},{type:"Feature",geometry:{
type:"LineString",coordinates:[[1722189.2376968332,5955247.381030541],[1722188.867685093,5955246.649177067]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722192.5102379168,5955254.045174011],[1722193.3671061767,5955255.739990538]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722194.456805093,5955257.704007067],[1722195.3136744434,5955259.398825751]]}},{type:"Feature",geometry:{type:"LineString",coordinates:[[1722160.40733618,5955197.1488198815],[1722169.95994097,5955192.319197492]]}}]}},690:function(e,t,o){"use strict";var r=o(183);o.d(t,"a",function(){return n});var n=[new r.a({id:1,name:"OG3",building:1}),new r.a({id:2,name:"EG",building:1})]},691:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",id:1,geometry:{type:"LineString",coordinates:[[1722178.9470130377,5955230.595548892],[1722198.6534343925,5955261.05092735]]}},{type:"Feature",id:2,geometry:{type:"LineString",coordinates:[[1722178.9470130377,5955230.595548892],[1722197.1605236838,5955255.82573987]]}},{type:"Feature",id:3,geometry:{type:"LineString",coordinates:[[1722178.9470130377,5955230.595548892],[1722193.428246912,5955247.465439901]]}},{type:"Feature",id:4,geometry:{type:"LineString",coordinates:[[1722178.9470130377,5955230.595548892],[1722191.9353362035,5955242.389543491]]}}]}},692:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=[{id:11,name:"Hörsaal 1",floor:-1},{id:12,name:"Hörsaal 2",floor:-1},{id:13,name:"Hörsaal 3",floor:0},{id:14,name:"WC",floor:1},{id:15,name:"Besprechungsraum A1",floor:-1},{id:16,name:"Besprechungsraum A2",floor:-1},{id:17,name:"Besprechungsraum A3",floor:5},{id:18,name:"Besprechungsraum A4",floor:-1},{id:19,name:"Besprechungsraum B1",floor:-1},{id:20,name:"Besprechungsraum B2",floor:-1}]},693:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=[{layer:0,geojson:{type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[1722152.223911352,5955326.29112532],[1722145.0579399504,5955313.899966438],[1722166.107980943,5955304.046755761],[1722139.0862971158,5955254.482120233]]}}]}},{layer:1,geojson:{type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[1722139.0862971158,5955254.482120233],[1722166.8544362977,5955241.643088137],[1722173.7218255575,5955263.887457697],[1722191.9353362035,5955256.721486296],[1722188.053768361,5955249.256932751],[1722193.1296647706,5955247.1668577595]]}}]}}]},694:function(e,t,o){"use strict";var r=o(0),n=o(71);o.d(t,"a",function(){return s});var i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(){function e(){this.modes=n.c,this.currentAppMode=n.a.CreateDefault(),this.currentAppModeEvt=new r._20}return e.prototype.ngOnInit=function(){},e.prototype.modechanged=function(e){console.log("ModeselectorComponent Mode changed: "+e.name),this.currentAppMode=e,this.currentAppModeEvt.emit(this.currentAppMode)},i([o.i(r.C)(),a("design:type",Object)],e.prototype,"currentAppModeEvt",void 0),e=i([o.i(r.G)({selector:"app-modeselector",template:o(869),styles:[o(860)]}),a("design:paramtypes",[])],e)}()},695:function(e,t,o){"use strict";var r=o(0),n=o(52),i=o(74),a=o(35);o.d(t,"a",function(){return l});var s=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.pois=null,this.showControl=!1,this.selectedPoiType=null,this.currentSelectedPoiEvt=new r._20,this.poiTypeReceivedEvt=new r._20}return e.prototype.ngOnInit=function(){a.a&&(this.mapService=this.mapServiceHttp),this.updateData()},e.prototype.updateData=function(){var e=this;this.mapService.getPoiTypes().subscribe(function(t){return e.updatePois(t)},function(e){return console.log("ERROR deleteNode: "+e)})},e.prototype.onSelect=function(e){this.selectPoi(e)},e.prototype.updatePois=function(e){this.pois=e,this.pois.length>0&&(this.showControl=!0,this.selectPoi(this.pois[0])),this.poiTypeReceivedEvt.emit(this.pois)},e.prototype.selectPoi=function(e){this.selectedPoiType=e,this.currentSelectedPoiEvt.emit(this.selectedPoiType)},s([o.i(r.C)(),c("design:type",Object)],e.prototype,"currentSelectedPoiEvt",void 0),s([o.i(r.C)(),c("design:type",Object)],e.prototype,"poiTypeReceivedEvt",void 0),e=s([o.i(r.G)({selector:"app-poiselector",template:o(870),styles:[o(861)]}),c("design:paramtypes",["function"==typeof(t="undefined"!=typeof i.a&&i.a)&&t||Object,"function"==typeof(l="undefined"!=typeof n.a&&n.a)&&l||Object])],e);var t,l}()},696:function(e,t,o){"use strict";var r=o(0),n=o(1),i=(o.n(n),o(7)),a=(o.n(i),o(52)),s=o(74),c=o(35);o.d(t,"a",function(){return p});var l=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.searchTerms=new i.Subject,this.currentSearchTerm=""}return e.prototype.ngOnInit=function(){var e=this;c.a&&(this.mapService=this.mapServiceHttp),this.rooms=this.searchTerms.debounceTime(300).distinctUntilChanged().switchMap(function(t){return t?e.mapService.searchRoom(t):n.Observable.of([])}).catch(function(e){return console.log(e),n.Observable.of([])})},e.prototype.search=function(e){this.searchTerms.next(e)},e.prototype.selectRoom=function(e){console.log("Select Room: "+e.id+"#"+e.name),this.currentSearchTerm="",this.searchTerms.next(this.currentSearchTerm)},e=l([o.i(r.G)({selector:"app-roomsearch",template:o(871),styles:[o(862)]}),u("design:paramtypes",["function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object,"function"==typeof(p="undefined"!=typeof a.a&&a.a)&&p||Object])],e);var t,p}()},697:function(e,t,o){"use strict";var r=o(0),n=o(34),i=o(7),a=(o.n(i),o(52)),s=o(74),c=o(35);o.d(t,"a",function(){return p});var l=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.showsuggestions=!1,this.searchTerms=new i.Subject,this.currentSearchTerm="",this.term=new n.d}return e.prototype.ngOnInit=function(){var e=this;c.a&&(this.mapService=this.mapServiceHttp),this.term.valueChanges.debounceTime(400).distinctUntilChanged().flatMap(function(t){return e.mapService.searchRoom(t)}).subscribe(function(t){return e.searchResults(t)})},e.prototype.searchResults=function(e){console.log("searchResults: "),this.rooms=e,this.showsuggestions=this.rooms.length>0,console.log("Showsuggestions: "+this.showsuggestions)},e.prototype.log=function(e){console.log("log: "+e)},e.prototype.selectRoom=function(e){console.log("Select Room: "+e.id+"#"+e.name),this.currentSearchTerm="",this.searchTerms.next(this.currentSearchTerm)},e=l([o.i(r.G)({selector:"app-roomsearchmd",template:o(872),styles:[o(863)]}),u("design:paramtypes",["function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object,"function"==typeof(p="undefined"!=typeof a.a&&a.a)&&p||Object])],e);var t,p}()},698:function(e,t,o){"use strict";var r=o(0),n=o(52),i=o(74),a=o(35),s=o(447);o.d(t,"a",function(){return u});var c=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e,t){this.mapServiceHttp=e,this.mapService=t,this.routeVisible=!1}return e.prototype.ngOnInit=function(){a.a&&(this.mapService=this.mapServiceHttp)},e.prototype.toogleroute=function(){var e=this;console.log("Toogle Route"),this.routeVisible?(this.mapComponentRef.hideRoute(),this.routeVisible=!1):this.mapService.addEdge(14,16,1.123,{type:"LineString",coordinates:[[1722178.9470130377,5955230.595548892],[1722198.6534343925,5955261.05092735]]}).subscribe(function(t){return e.edgeAdded(t)},function(e){return console.log("ERROR: "+e)})},e.prototype.edgeAdded=function(e){var t=this;console.log("edgeAdded... "+JSON.stringify(e)),e.properties.destination=19,this.mapService.updateEdge(e,e.id).subscribe(function(e){return t.edgeUpdated(e)},function(e){return console.log("ERROR: "+e)})},e.prototype.edgeDeleted=function(e){console.log("edgeDeleted... "+JSON.stringify(e))},e.prototype.edgeUpdated=function(e){console.log("edgeUpdated... "+JSON.stringify(e))},e.prototype.showRoute=function(e){this.mapComponentRef.showRoute(e),this.routeVisible=!0},c([o.i(r.B)(),l("design:type","function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object)],e.prototype,"mapComponentRef",void 0),e=c([o.i(r.G)({selector:"app-routetest",template:o(873),styles:[o(864)]}),l("design:paramtypes",["function"==typeof(u="undefined"!=typeof i.a&&i.a)&&u||Object,"function"==typeof(p="undefined"!=typeof n.a&&n.a)&&p||Object])],e);var t,u,p}()},699:function(e,t,o){"use strict";var r=o(35);o.d(t,"a",function(){return n});var n=function(){function e(e){this.mapService=e,this.isActive=!1}return e.prototype.Initialize=function(e){this.select=e;var t={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]};this.edgeLayerSource=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(t)}),this.edgePathLayerSource=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(t)});var o=function(e){return new ol.style.Style({stroke:new ol.style.Stroke({color:"green",width:1})})},r=function(e){return new ol.style.Style({stroke:new ol.style.Stroke({color:"green",lineDash:[5],width:3})})};this.edgeLayer=new ol.layer.Vector({source:this.edgeLayerSource,style:o}),this.edgePathLayer=new ol.layer.Vector({source:this.edgePathLayerSource,style:r,zIndex:10}),this.edgePathLayer.set("isSelectable",!0)},e.prototype.getEdgeLayer=function(){return this.edgeLayer},e.prototype.getEdgePathLayer=function(){return this.edgePathLayer},e.prototype.addEdge=function(e,t,o,n){var i=this;return r.a?void this.mapService.addEdge(e,t,o,n).subscribe(function(e){return i.updateAddEdge(e)}):void console.log("Offline mode, dont add edge!")},e.prototype.deleteSelectedEdge=function(){for(var e=this,t=0,o=this.select.getFeatures().getArray();t<o.length;t++){var n=o[t];if(!r.a)return void console.log("Offline mode, dont delete edge!");this.mapService.deleteEdge(n.getId()).subscribe(function(t){return e.edgeDeleted(t)},function(e){return console.log("ERROR deleteEdge: "+e)})}},e.prototype.edgeDeleted=function(e){console.log("edgeDeleted..."+JSON.stringify(e));var t=this.edgeLayerSource.getFeatureById(e.id);t&&this.edgeLayerSource.removeFeature(t),t=this.edgePathLayerSource.getFeatureById(e.id),t&&this.edgePathLayerSource.removeFeature(t)},e.prototype.updateEdges=function(e){var t=this;if(console.log("updateEdges... "),!r.a)return void console.log("Offline mode, dont update edge!");for(var o=0,n=e;o<n.length;o++){var i=n[o];console.log("updateEdge: "+JSON.stringify(i.getId())),this.mapService.updateEdge((new ol.format.GeoJSON).writeFeature(i),i.getId()).subscribe(function(e){return t.edgeUpdated(e)},function(e){return console.log("ERROR: "+e)})}},e.prototype.edgeUpdated=function(e){console.log("edgeUpdated... "+JSON.stringify(e))},e.prototype.showEdges=function(e){console.log("showRoute called"),this.edgeLayerSource.clear(),this.edgeLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e)),this.edgePathLayerSource.clear(),this.edgePathLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},e.prototype.updateAddEdge=function(e){console.log("updateAddEdge! - "+JSON.stringify(e)),this.edgeLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e)),this.edgePathLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},e}()},700:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){this.isActive=!1,this.featureOverlay=null,this.selectedRoomOverlay=null,this.selectedRoom=null,this.navigationMap=null}return e.prototype.Initialize=function(e){this.navigationMap=e;var t={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]};console.log("Create Room LAYER SOURCE!!!"),this.roomLayerSource=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(t)});var o=function(e){return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(128,0,255,0.5)"})})};this.roomLayer=new ol.layer.Vector({source:this.roomLayerSource,style:o})},e.prototype.getRoomLayer=function(){return this.roomLayer},e.prototype.showRooms=function(e){this.roomLayerSource.clear(),this.roomLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e))},e.prototype.mouseMoved=function(e,t){null===this.featureOverlay&&this.initFeatureOverlay(t);var o=t.forEachFeatureAtPixel(e,function(e){return e});o!==this.highlight&&(this.highlight&&this.featureOverlay.getSource().removeFeature(this.highlight),o&&this.featureOverlay.getSource().addFeature(o),this.highlight=o)},e.prototype.mouseClicked=function(e,t){null!=this.highlight&&(null==this.selectedRoomOverlay&&this.initSelectedRoomOverlay(t),this.selectedRoom=this.highlight,this.selectedRoomOverlay.getSource().clear(),this.selectedRoomOverlay.getSource().addFeature(this.highlight))},e.prototype.mouseClickedCtrl=function(e,t){null!=this.selectedRoom&&null!=this.highlight&&(console.log("Add Edge: "+this.selectedRoom.getId()+"/"+this.highlight.getId()),this.addEdge(this.selectedRoom,this.highlight))},e.prototype.addEdge=function(e,t){var o=e.getId(),r=t.getId();if(o!=r){var n=e.getGeometry().getInteriorPoint().B,i=t.getGeometry().getInteriorPoint().B,a=new ol.geom.LineString([n,i]),s=a.getLength();console.log("RoomMap::addEdge "+o+"/"+r+"#"+JSON.stringify(n)+"/ "+JSON.stringify(i)+"--"+s);var c={type:"LineString",coordinates:[n,i]};this.navigationMap.addEdge(o,r,s,c)}},e.prototype.Clear=function(){this.selectedRoomOverlay&&this.selectedRoomOverlay.getSource().clear(),this.featureOverlay&&this.featureOverlay.getSource().clear(),this.selectedRoom=null,this.highlight=null},e.prototype.initFeatureOverlay=function(e){this.featureOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:e,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:1}),fill:new ol.style.Fill({color:"rgba(255,0,0,0.8)"})})})},e.prototype.initSelectedRoomOverlay=function(e){this.selectedRoomOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:e,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:1}),fill:new ol.style.Fill({color:"rgba(0,128,255,0.8)"})})})},e}()},701:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){this.isActive=!1}return e.prototype.Initialize=function(){var e={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]};console.log("Create Route LAYER SOURCE!!!"),this.routeLayerSource=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e)}),this.routeLayerSourceHidden=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e)});var t=function(e){return new ol.style.Style({stroke:new ol.style.Stroke({color:"blue",lineDash:[5],width:2})})},o=function(e){return new ol.style.Style({stroke:new ol.style.Stroke({color:"blue",width:2})})};this.routeLayer=new ol.layer.Vector({source:this.routeLayerSource,style:t}),this.routeLayerHidden=new ol.layer.Vector({source:this.routeLayerSourceHidden,style:o})},e.prototype.getRouteLayer=function(){return this.routeLayer},e.prototype.getHiddenRouteLayer=function(){return this.routeLayerHidden},e.prototype.showRoute=function(e){console.log("showRoute called"),this.routeLayerSource.clear(),this.routeLayerSourceHidden.clear();for(var t=0;t<e.length;t++)0==e[t].layer?this.routeLayerSource.addFeatures((new ol.format.GeoJSON).readFeatures(e[t].geojson)):this.routeLayerSourceHidden.addFeatures((new ol.format.GeoJSON).readFeatures(e[t].geojson))},e.prototype.hideRoute=function(){console.log("hideRoute called"),this.routeLayerSource.clear(),this.routeLayerSourceHidden.clear()},e}()},702:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r={production:!0}},703:function(e,t,o){"use strict";var r=o(717),n=(o.n(r),o(710)),i=(o.n(n),o(706)),a=(o.n(i),o(712)),s=(o.n(a),o(711)),c=(o.n(s),o(709)),l=(o.n(c),o(708)),u=(o.n(l),o(716)),p=(o.n(u),o(705)),d=(o.n(p),o(704)),h=(o.n(d),o(714)),y=(o.n(h),o(707)),g=(o.n(y),o(715)),f=(o.n(g),o(713)),m=(o.n(f),o(718)),S=(o.n(m),o(1135));o.n(S)},71:function(e,t,o){"use strict";o.d(t,"b",function(){return r}),o.d(t,"a",function(){return n}),o.d(t,"c",function(){return i});var r;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.EDIT_NODES=1]="EDIT_NODES",e[e.EDIT_POIS=2]="EDIT_POIS",e[e.EDIT_BACKGROUND=3]="EDIT_BACKGROUND"}(r||(r={}));var n=function(){function e(e,t){this.mode=e,this.name=t}return e.CreateDefault=function(){return new e(r.EDIT_NODES,"Navigationsmesh")},e}(),i=[n.CreateDefault(),new n(r.EDIT_POIS,"Points of Interest")]},72:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=function(){function e(){this.subscription=null}return e.prototype.getLayer=function(){return this.layer},e.prototype.setActive=function(e){this.layer.setVisible(e),e||this.clearSelection()},e.prototype.clear=function(){this.clearSelection(),this.layerSource.clear()},e.prototype.clearSelection=function(){},e.prototype.subscribeNewRequest=function(e){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.subscription=e},e}()},73:function(e,t,o){"use strict";var r=o(71);o.d(t,"a",function(){return n});var n=function(){function e(){}return e.CreateBasicLayer=function(e){var t={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]};console.log("Create Wall layer source!");var o=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(t)}),r=new ol.layer.Vector({source:o,style:e});return{layer:r,layerSource:o}},e.CurrentApplicationMode=r.a.CreateDefault(),e}()},74:function(e,t,o){"use strict";var r=o(0),n=o(124),i=o(1),a=(o.n(i),o(296)),s=(o.n(a),o(105)),c=(o.n(s),o(52)),l=o(183),u=o(446);o.d(t,"a",function(){return y});var p=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},d=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},h=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e){function t(t){e.call(this),this.http=t,this.baseUrl="/v1",this.roomUrl=this.baseUrl+"/geo/rooms/",this.edgeUrl=this.baseUrl+"/geo/edges/",this.floorUrl=this.baseUrl+"/geo/floors/",this.nodeUrl=this.baseUrl+"/geo/nodes/",this.doorUrl=this.baseUrl+"/geo/doors/",this.levelUrl=this.baseUrl+"/geo/level/",this.routeUrl=this.baseUrl+"/geo/routing/edges/",this.poiTypeUrl=this.baseUrl+"/geo/pointofinterest/",this.poiInstanceUrl=this.baseUrl+"/geo/pointofinterestinstance/"}return p(t,e),t.prototype.getRooms=function(e){return this.http.get(this.roomUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.getNavigationEdges=function(e){return this.http.get(this.edgeUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.getNavigationNodes=function(e){return this.http.get(this.nodeUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.getFloorNames=function(){return this.http.get(this.levelUrl).map(this.extractDataFloors).catch(this.handleError)},t.prototype.getDoors=function(e){return this.http.get(this.doorUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.getFloors=function(e){return this.http.get(this.floorUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.getRoute=function(e,t){return console.log("Get Route HTTP!"),this.http.get(this.routeUrl+"?from="+e+"&to="+t).map(this.extractData).catch(this.handleError)},t.prototype.getPoiTypes=function(){return this.http.get(this.poiTypeUrl).map(this.extractDataPoiTypes).catch(this.handleError)},t.prototype.getPoiInstances=function(e){return this.http.get(this.poiInstanceUrl+"?level="+e).map(this.extractData).catch(this.handleError)},t.prototype.addEdge=function(e,t,o,r){var i=new n.c({"Content-Type":"application/json"}),a=new n.d({headers:i}),s={source:e,destination:t,path:JSON.stringify(r),length:o};return this.http.post(this.edgeUrl,s,a).map(this.extractDataAdd).catch(this.handleError)},t.prototype.addNode=function(e,t){var o=new n.c({"Content-Type":"application/json"}),r=new n.d({headers:o}),i={level:e,center:JSON.stringify(t)};return console.log("Send Node: "+JSON.stringify(i)),this.http.post(this.nodeUrl,i,r).map(this.extractDataAdd).catch(this.handleError)},t.prototype.addPoiInstance=function(e,t,o){var r=new n.c({"Content-Type":"application/json"}),i=new n.d({headers:r}),a={level:e,name:o,center:JSON.stringify(t)};return console.log("Send PoiInstance: "+JSON.stringify(a)),this.http.post(this.poiInstanceUrl,a,i).map(this.extractDataAdd).catch(this.handleError)},t.prototype.deleteNode=function(e){var t=this,o=new n.c({}),r=new n.d({headers:o});return this.http.delete(this.nodeUrl+e+"/",r).map(function(o){return t.extractDataDel(o,e)}).catch(this.handleError)},t.prototype.deleteEdge=function(e){var t=this,o=new n.c({}),r=new n.d({headers:o});return this.http.delete(this.edgeUrl+e+"/",r).map(function(o){return t.extractDataDel(o,e)}).catch(this.handleError)},t.prototype.deletePoi=function(e){var t=this,o=new n.c({}),r=new n.d({headers:o});return this.http.delete(this.poiInstanceUrl+e+"/",r).map(function(o){return t.extractDataDel(o,e)}).catch(this.handleError)},t.prototype.updateEdge=function(e,t){var o=new n.c({"Content-Type":"application/json"}),r=new n.d({headers:o});return this.http.put(this.edgeUrl+t+"/",e,r).map(this.extractDataAdd).catch(this.handleError)},t.prototype.updateNode=function(e,t){var o=new n.c({"Content-Type":"application/json"}),r=new n.d({headers:o});return this.http.put(this.nodeUrl+t+"/",e,r).map(this.extractDataAdd).catch(this.handleError)},t.prototype.updatePoi=function(e,t){var o=new n.c({"Content-Type":"application/json"}),r=new n.d({headers:o});return this.http.put(this.poiInstanceUrl+t+"/",e,r).map(this.extractDataAdd).catch(this.handleError)},t.prototype.extractData=function(e){var t=e.json();return t.results?t.results||{}:t||{}},t.prototype.extractDataAdd=function(e){var t=e.json();return t||{}},t.prototype.extractDataDel=function(e,t){return{id:t}},t.prototype.extractDataFloors=function(e){var t=e.json();t.results&&(t=t.results),console.log("RESPONSE DATA FLOORS: "+JSON.stringify(t));for(var o=[],r=0,n=t;r<n.length;r++){var i=n[r];o.push(new l.a(i))}return o},t.prototype.extractDataPoiTypes=function(e){var t=e.json();t.results&&(t=t.results),console.log("RESPONSE DATA POITYPES: "+JSON.stringify(t));for(var o=[],r=0,n=t;r<n.length;r++){var i=n[r];o.push(new u.a(i))}return o},t.prototype.handleError=function(e){var t;if(e instanceof n.e){var o=e.json()||"",r=o.error||JSON.stringify(o);t=e.status+" - "+(e.statusText||"")+" "+r}else t=e.message?e.message:e.toString();return console.error("handleError: "+t),i.Observable.throw(t)},t=d([o.i(r.R)(),h("design:paramtypes",["function"==typeof(a="undefined"!=typeof n.a&&n.a)&&a||Object])],t);var a}(c.a)},857:function(e,t){e.exports="\n\n.app-toolbar-filler{\n  -webkit-box-flex:1;\n      -ms-flex:1 1 auto;\n          flex:1 1 auto;\n  height:3em;\n}\n\n.header-toolbar{\n  position:absolute;\n  top:0em;\n  bottom:0;\n  right:0;\n  left:0;\n  background-color:#51ae32;\n  color:#ffffff;\n  height:3em;\n  margin:0;\n  z-index:1;\n}\n"},858:function(e,t){e.exports=".map{\r\n  position:absolute; //top:3.5em;\r\n  top:0;\r\n  bottom:0;\r\n  right:0;\r\n  left:0;\r\n  z-index:0;\r\n}\r\n"},859:function(e,t){e.exports=".floorselector{\r\n  position:absolute;\r\n  bottom:1.0em;\r\n  left:1.0em;\r\n  z-index:10;\r\n  background-color:#FFFFFF80;\r\n  font-size:medium;\r\n}\r\n\r\n.floormenubutton{\r\n  background-color:#FFFFFFFF;\r\n  border:medium medium;\r\n  box-shadow:1px 1px 1px rgba(0, 0, 0, 0.2);\r\n  min-width:6em;\r\n  padding:0;\r\n}\r\n\r\n.floormenutext{\r\n  font-size:medium;\r\n}\r\n\r\n.floormenuIcon{\r\n  color:#51AE32;\r\n  margin-right:0.2em;\r\n}\r\n"},860:function(e,t){e.exports=".modeselector{\r\n  position:absolute;\r\n  top:1.0em;\r\n  left:0.7em;\r\n  z-index:1;\r\n  background-color:#FFFFFF80;\r\n  border-radius:0.5em;\r\n}\r\n\r\n.modeselectormenu{\r\n  background-color:#FFFFFFFF;\r\n}\r\n"},861:function(e,t){e.exports=".poicontrol{\r\n  position:absolute;\r\n  top:4.0em;\r\n  left:0.7em;\r\n  z-index:10;\r\n  background-color:#FFFFFF80;\r\n  font-size:medium;\r\n}\r\n\r\n.poicontrolmenubutton{\r\n  background-color:#FFFFFFFF;\r\n  border:medium medium;\r\n  box-shadow:1px 1px 1px rgba(0, 0, 0, 0.2);\r\n  min-width:6em;\r\n  padding:0;\r\n  vertical-align:middle;\r\n}\r\n\r\n.poicontrolmenutext{\r\n  font-size:medium;\r\n  margin-right:0.5em;\r\n}\r\n\r\n.poicontrolmenuIcon{\r\n  margin:0;\r\n  padding:0;\r\n  margin-right:0.2em;\r\n  float:left;\r\n}\r\n"},862:function(e,t){e.exports=".roomsearch{\n  position:absolute;\n  top:0.7em;\n  left:4.7em;\n  z-index:1;\n  background-color:#FFFFFF80;\n  border-radius:0.5em;\n}\n\n.search-result{\n  border-bottom:1px solid gray;\n  border-left:1px solid gray;\n  border-right:1px solid gray;\n  width:195px;\n  height:20px;\n  padding:5px;\n  background-color:white;\n  cursor:pointer;\n}\n#search-box{\n  width:200px;\n  height:20px;\n}\n"},863:function(e,t){e.exports=".placeholder-white{\n  color:#ffffff;\n}\n"},864:function(e,t){e.exports=".routetest{\n  position:absolute;\n  top:8.0em;\n  left:0.7em;\n  z-index:1;\n  background-color:#FFFFFF80;\n  border-radius:0.5em;\n}\n\n.routetestbutton{\n  background-color:#FFFFFFFF;\n}\n"},865:function(e,t){e.exports='.map{\n  position:absolute;\n  top:3.5em;\n  bottom:0;\n  right:0;\n  left:0;\n  z-index:0;\n}\n\n.ol-popup{\n  position:absolute;\n  background-color:white;\n  -webkit-filter:drop-shadow(0 1px 4px rgba(0,0,0,0.2));\n  filter:drop-shadow(0 1px 4px rgba(0,0,0,0.2));\n  padding:15px;\n  border-radius:10px;\n  border:1px solid #cccccc;\n  bottom:12px;\n  left:-50px;\n}\n.ol-popup:after, .ol-popup:before{\n  top:100%;\n  border:solid transparent;\n  content:" ";\n  height:0;\n  width:0;\n  position:absolute;\n  pointer-events:none;\n}\n.ol-popup:after{\n  border-top-color:white;\n  border-width:10px;\n  left:48px;\n  margin-left:-10px;\n}\n.ol-popup:before{\n  border-top-color:#cccccc;\n  border-width:11px;\n  left:48px;\n  margin-left:-11px;\n}\n.ol-popup-closer{\n  text-decoration:none;\n  position:absolute;\n  top:2px;\n  right:8px;\n}\n.ol-popup-closer:after{\n  content:"✖";\n}\n'},866:function(e,t){e.exports='<!--<app-testmap #mapComp [applicationMode]="currentAppMode"></app-testmap>\r\n<app-routetest [mapComponentRef] = mapComp *ngIf="currentAppMode && currentAppMode.showDemoRoute"></app-routetest>\r\n-->\r\n\r\n\r\n<app-editablemap #mapComp\r\n  [applicationMode]="currentAppMode"\r\n  [currentFloor]="currentFloor"\r\n  [poiTypes]="poiTypes"\r\n  [currentPoiType]="currentPoiType">\r\n</app-editablemap>\r\n<app-floorselector (currentFloorEvt)="floorChanged($event)"></app-floorselector>\r\n<app-modeselector (currentAppModeEvt)="appModeChanged($event)"></app-modeselector>\r\n<app-poiselector (currentSelectedPoiEvt)="currentPoiTypeChanged($event)"\r\n                  (poiTypeReceivedEvt)="PoiTypesReceived($event)"\r\n                  *ngIf="showPoiSelector"></app-poiselector>\r\n\r\n<!--\r\n<md-toolbar class = "header-toolbar">\r\n  <span>Medcampus</span>\r\n\r\n  <span class="app-toolbar-filler"></span>\r\n\r\n  <app-roomsearchmd></app-roomsearchmd>\r\n\r\n</md-toolbar>\r\n-->\r\n<!--\r\n<md-toolbar>\r\n  TestToolbar\r\n</md-toolbar>\r\n\r\n\r\n\r\n<md-card>\r\n  <p>Last dialog result: {{lastDialogResult}}</p>\r\n  <button md-icon-button (click)="openDialog()">\r\n     <md-icon>navigation</md-icon>\r\n  </button>\r\n</md-card>\r\n-->\r\n'},867:function(e,t){e.exports='<div id="map" class="map">\n</div>\n<!--\n<div id="roomPopup" #roomPopup class="ol-popup">-->\n    <!--<a href="#" id="popup-closer" class="ol-popup-closer"></a>-->\n<!--    <div id="popup-content">Hi!..........</div>\n</div> -->\n'},868:function(e,t){e.exports='<div class="floorselector" *ngIf="selectedFloor">\r\n\r\n  <button md-raised-button [mdMenuTriggerFor]="menufloors" class="floormenu">\r\n     <md-icon class="floormenuIcon">layers</md-icon><span>{{selectedFloor.name}}</span>\r\n  </button>\r\n  <md-menu #menufloors="mdMenu">\r\n    <button md-menu-item *ngFor="let floor of floorList" (click)="onSelect(floor)" class="floormenutext">{{floor.name}}</button>\r\n  </md-menu>\r\n</div>\r\n'},869:function(e,t){e.exports='<div class="modeselector">\n  <!--\n  <md-button-toggle-group #group="mdButtonToggleGroup" (change)="modechanged()">\n    <table>\n      <tr *ngFor="let mode of modes">\n        <td>\n          <md-button-toggle (change)="modechanged(mode)">\n            {{mode.name}}\n          </md-button-toggle>\n        </td>\n      </tr>\n  </table>\n</md-button-toggle-group>\n-->\n  <button md-raised-button [mdMenuTriggerFor]="menuApplicationmodes" class="modemenu">\n     <md-icon>more_vert</md-icon><span>{{currentAppMode.name}}</span>\n  </button>\n  <md-menu #menuApplicationmodes="mdMenu">\n       <button md-menu-item  *ngFor="let mode of modes" (click)="modechanged(mode)">{{mode.name}}</button>\n  </md-menu>\n</div>\n'},870:function(e,t){e.exports='<div class="poicontrol" *ngIf="showControl">\r\n  <button md-raised-button [mdMenuTriggerFor]="menuselectcontrol" class="poicontrolmenubutton">\r\n     <img class="poicontrolmenuIcon" src="{{selectedPoiType.iconurl}}" alt="{{selectedPoiType.name}}"><span class="poicontrolmenutext">{{selectedPoiType.name}}</span>\r\n  </button>\r\n  <md-menu #menuselectcontrol="mdMenu">\r\n    <button md-menu-item *ngFor="let poi of pois" (click)="onSelect(poi)" class="poicontrolmenubutton">\r\n      <img class="poicontrolmenuIcon" src="{{poi.iconurl}}" alt="{{poi.name}}">\r\n      <span class="poicontrolmenutext">{{poi.name}}</span>\r\n    </button>\r\n  </md-menu>\r\n</div>\r\n';
},871:function(e,t){e.exports='\n<div class="roomsearch">\n  <input #searchBox id="search-box" (keyup)="search(searchBox.value)"\n    placeholder="Suche Raum..." [(ngModel)] = "currentSearchTerm" />\n  <div>\n    <div *ngFor="let room of rooms | async"\n         (click)="selectRoom(room)" class="search-result" >\n      {{room.name}}\n    </div>\n  </div>\n</div>\n'},872:function(e,t){e.exports='\n<table>\n  <tr>\n    <td>\n      <i class="material-icons app-input-icon">search</i>\n    </td>\n    <td>\n      <md-input-container>\n        <input type="text" mdInput [formControl]="term" [mdAutocomplete]="auto">\n      </md-input-container>\n    </td>\n  </tr>\n</table>\n\n<md-autocomplete #auto="mdAutocomplete">\n   <md-option *ngFor="let room of rooms" [value]="room.name" (click)="selectRoom(room)">\n      {{ room.name }}\n   </md-option>\n</md-autocomplete>\n\n\n<!--\n<i class="material-icons app-input-icon">search</i>\n\n<md-input-container>\n  <input mdInput #searchBox  placeholder="Raumsuche" class="placeholder-white" floatingPlaceholder=true [formControl]="term">\n</md-input-container>\n\n<div [hidden]="!showsuggestions">\n  <div [hidden]="true">\n    <button md-raised-button [mdMenuTriggerFor]="menusearch" class="floormenu">\n    </button>\n  </div>\n\n  <md-menu #menusearch="mdMenu" [hidden]="!showsuggestions">\n       <button md-menu-item *ngFor="let room of rooms" (click)="selectRoom(room)">{{room.name}}</button>\n  </md-menu>\n</div>\n-->\n\n\n<!--\n<div class="suggestions" *ngIf="rooms.length > 0">\n    <ul>\n        <li *ngFor="let room of rooms">\n            <a (click)="selectRoom(room)">{{room.name}}</a>\n        </li>\n    </ul>\n</div>\n-->\n'},873:function(e,t){e.exports='<div class="routetest">\n  <button md-raised-button (click)="toogleroute()" class="routetestbutton">\n     <md-icon>directions</md-icon><span></span>\n  </button>\n</div>\n'},874:function(e,t){e.exports='<!--<p>\n  testmap works!\n</p>-->\n<div id="map" class="map">\n</div>\n<div id="roomPopup" #roomPopup class="ol-popup">\n    <!--<a href="#" id="popup-closer" class="ol-popup-closer"></a>-->\n    <div id="popup-content">Hi!..........</div>\n</div>\n'}},[1136]);
//# sourceMappingURL=main.4ff08e57ed7ba54973ed.bundle.map